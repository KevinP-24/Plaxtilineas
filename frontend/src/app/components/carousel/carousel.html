<div class="carousel-container" 
     (mouseenter)="onMouseEnter()" 
     (mouseleave)="onMouseLeave()"
     (touchstart)="onTouchStart($event)"
     (touchmove)="onTouchMove($event)"
     (touchend)="onTouchEnd()">
  
  <!-- Título de la categoría -->
  <div class="categoria-header" *ngIf="categoriaNombre">
    <h2 class="categoria-titulo">{{ categoriaNombre }}</h2>
  </div>
  
  <!-- Estado de carga -->
  <div *ngIf="cargando" class="estado-mensaje">
    <div class="spinner"></div>
    <p>Cargando productos de {{ categoriaNombre }}...</p>
  </div>
  
  <!-- Error -->
  <div *ngIf="error && !cargando" class="estado-mensaje error">
    <p>{{ error }}</p>
  </div>
  
  <!-- Carrusel de productos -->
  <div *ngIf="!cargando && !error && productos.length > 0" class="carousel-content">
    
    <!-- Botón anterior -->
    <button 
      *ngIf="productos.length > itemsPerView"
      class="nav-btn prev-btn" 
      (click)="prev()"
      [disabled]="!hasPrev()"
      aria-label="Productos anteriores">
      ‹
    </button>
    
    <!-- Contenedor de productos -->
    <div class="productos-container">
      <div 
        class="productos-slide"
        [style.transform]="getTransformValue()">
        
        <div 
          *ngFor="let producto of productos; trackBy: trackByProductId" 
          class="producto-item"
          [style.flex-basis]="'calc(100% / ' + itemsPerView + ')'"
          (click)="verDetalles(producto.id)">
          
          <!-- Tarjeta de producto clickeable -->
          <div class="producto-card clickable">
            <!-- Logo de la empresa -->
            <div class="producto-logo">
              <img 
                src="https://res.cloudinary.com/dsv1gdgya/image/upload/v1768353039/plaxtilineas-card_ktwfqq.png" 
                alt="Logo empresa" 
                class="logo">
            </div>
            
            <!-- Imagen del producto -->
            <div class="producto-imagen">
              <img 
                [src]="producto.imagen_url" 
                [alt]="producto.nombre"
                class="imagen"
                loading="lazy">
                <!-- Se eliminó el (error) que causaba el problema -->
            </div>
            
            <!-- Información del producto -->
            <div class="producto-info">
              <!-- Nombre del producto -->
              <span class="product-name">{{ producto.nombre }}</span>
              
              <!-- Precio con estructura elegante -->
              <div class="price-display">
                <div class="price-label-area">
                  <span class="price-label">Precio:</span>
                </div>
                <div class="price-value-area">
                  <span class="price-value">{{ formatearPrecio(producto.precio) }}</span>
                </div>
              </div>
            </div>
          </div>
          
        </div>
      </div>
    </div>
    
    <!-- Botón siguiente -->
    <button 
      *ngIf="productos.length > itemsPerView"
      class="nav-btn next-btn" 
      (click)="next()"
      [disabled]="!hasNext()"
      aria-label="Siguientes productos">
      ›
    </button>
  </div>
  
  <!-- Mensaje si no hay productos -->
  <div *ngIf="!cargando && !error && productos.length === 0" class="estado-mensaje">
    <p>No hay productos disponibles en "{{ categoriaNombre }}"</p>
  </div>
  
</div>