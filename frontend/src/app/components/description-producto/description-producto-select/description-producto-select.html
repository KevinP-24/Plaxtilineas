<div class="description-producto-container">
  
  <!-- Estado de carga -->
  <div *ngIf="cargando" class="loading-container">
    <div class="loading-spinner"></div>
    <p class="loading-text">Cargando detalles del producto...</p>
  </div>

  <!-- Estado de error -->
  <div *ngIf="error && !cargando" class="error-container">
    <div class="error-icon">‚ö†Ô∏è</div>
    <h2 class="error-title">Producto no encontrado</h2>
    <p class="error-message">El producto que buscas no existe o no est√° disponible.</p>
    <button class="error-button" (click)="volverAProductos()">
      Volver a productos
    </button>
  </div>

  <!-- Detalles del producto -->
  <div *ngIf="producto && !cargando && !error" class="producto-detalles">
    
    <!-- Breadcrumb de navegaci√≥n -->
    <nav class="breadcrumb">
      <a routerLink="/productos" class="breadcrumb-link">Productos</a>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-current">{{nombreCompleto}}</span>
    </nav>

    <!-- Contenedor principal con estructura de dos columnas fijas -->
    <div class="producto-layout-container">
      
      <!-- Columna Izquierda Fija: Imagen y Precio -->
      <div class="producto-columna-izquierda">
        
        <!-- Contenedor de imagen con tama√±o fijo -->
        <div class="producto-imagen-fixed-container" (click)="abrirModalImagen()">
          <div class="producto-imagen-wrapper">
            <img 
              [src]="producto.imagen_url" 
              [alt]="nombreCompleto" 
              class="producto-imagen-fixed"
              (error)="producto.imagen_url = 'assets/images/producto-default.jpg'">
            <div class="imagen-overlay-fixed"></div>
            <div class="imagen-zoom-indicator">
              <span class="zoom-icon">üîç</span>
              <span class="zoom-text">Haz clic para ampliar</span>
            </div>
          </div>
        </div>

        <!-- Precio fijo debajo de la imagen -->
        <div class="precio-fixed-container">
          <div class="precio-fixed-header">
            <span class="precio-fixed-label">Precio:</span>
            <span class="precio-fixed-badge" *ngIf="varianteSeleccionada">Seleccionado</span>
          </div>
          <div class="precio-fixed-valor">
            
            <span class="precio-numero-fixed">{{formatearPrecio(precioActual)}}</span>
          </div>
          <div class="precio-fixed-nota" *ngIf="variantes.length > 0">
            <small>Precio var√≠a seg√∫n la variante seleccionada</small>
          </div>
        </div>

        <!-- Acciones r√°pidas en columna izquierda -->
        <div class="acciones-rapidas-container">
          <a [href]="generarWhatsAppLink()"
             target="_blank"
             rel="noopener noreferrer nofollow"
             class="btn-whatsapp-fixed"
             aria-label="Consultar sobre este producto por WhatsApp"
             title="Consultar sobre este producto por WhatsApp">
            <span class="btn-icon-fixed">üí¨</span>
            <span class="btn-text-fixed">Consultar por WhatsApp</span>
          </a>
          
          <button class="btn-compartir-fixed" (click)="copiarEnlace()" title="Copiar enlace del producto">
            <span class="btn-icon-fixed">üîó</span>
            <span class="btn-text-fixed">Copiar enlace</span>
          </button>
          
          <div class="mensaje-copiado-fixed" *ngIf="enlaceCopiado">
            ‚úì Enlace copiado al portapapeles
          </div>
        </div>

      </div>

      <!-- Columna Derecha Fija: Informaci√≥n del Producto -->
      <div class="producto-columna-derecha">
        
        <!-- Encabezado -->
        <div class="producto-header-fixed">
          <div class="producto-categorias-fixed">
            <span class="categoria-badge-fixed">{{producto.categoria}}</span>
            <span class="subcategoria-badge-fixed">{{producto.subcategoria}}</span>
            <span class="producto-id-fixed">ID: {{producto.id}}</span>
          </div>
          <h1 class="producto-nombre-fixed">{{productoBaseNombre}}</h1>
        </div>

        <!-- Contenedor de informaci√≥n con altura fija y scroll interno -->
        <div class="producto-info-scroll-container">
          
          <!-- Selecci√≥n de variantes -->
          <div *ngIf="variantes.length > 0" class="opciones-fixed-container">
            <div class="section-header-fixed">
              <h3 class="section-title-fixed">Seleccionar variante</h3>
              <span class="section-subtitle">Selecciona una opci√≥n para actualizar el precio</span>
            </div>
            
            <div class="opciones-fixed-grid">
              <div 
                *ngFor="let variante of variantes" 
                class="opcion-fixed-item"
                [class.opcion-fixed-seleccionada]="varianteSeleccionada?.id === variante.id"
                (click)="seleccionarVariante(variante)">
                <div class="opcion-fixed-contenido">
                  <div class="opcion-fixed-info">
                    <span class="opcion-fixed-texto">{{variante.nombre}}</span>
                    <span class="opcion-fixed-precio">{{formatearPrecio(variante.precio)}}</span>
                  </div>
                  <div class="opcion-fixed-checkbox">
                    <div class="opcion-fixed-checkmark" *ngIf="varianteSeleccionada?.id === variante.id">‚úì</div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Resumen de variante seleccionada -->
            <div *ngIf="varianteSeleccionada" class="variante-seleccionada-resumen">
              <div class="variante-resumen-item">
                <span class="variante-resumen-label">Variante seleccionada:</span>
                <span class="variante-resumen-valor">{{varianteSeleccionada.nombre}}</span>
              </div>
              <div class="variante-resumen-item">
                <span class="variante-resumen-label">ID de variante:</span>
                <span class="variante-resumen-valor">{{varianteSeleccionada.id}}</span>
              </div>
            </div>
          </div>

          <!-- Descripci√≥n -->
          <div class="producto-descripcion-fixed-section">
            <div class="section-header-fixed">
              <h3 class="section-title-fixed">Descripci√≥n del producto</h3>
            </div>
            <div class="descripcion-fixed-content">
              <p class="producto-descripcion-fixed">
                {{descripcionBase || 'Descripci√≥n no disponible'}}
              </p>
            </div>
          </div>

          <!-- Detalles espec√≠ficos -->
          <div class="producto-detalles-fixed-section">
            <div class="section-header-fixed">
              <h3 class="section-title-fixed">Detalles del producto</h3>
            </div>
            <div class="detalles-fixed-grid">
              <div class="detalle-fixed-item">
                <span class="detalle-fixed-label">Categor√≠a:</span>
                <span class="detalle-fixed-valor">{{producto.categoria}}</span>
              </div>
              <div class="detalle-fixed-item">
                <span class="detalle-fixed-label">Subcategor√≠a:</span>
                <span class="detalle-fixed-valor">{{producto.subcategoria}}</span>
              </div>
              <div class="detalle-fixed-item">
                <span class="detalle-fixed-label">ID del producto:</span>
                <span class="detalle-fixed-valor">{{producto.id}}</span>
              </div>
              
            </div>
          </div>

          <!-- Acciones adicionales -->
          <div class="acciones-adicionales-container">
            <button class="btn-volver-fixed" (click)="volverAProductos()">
              <span class="btn-icon-fixed">‚Üê</span>
              <span class="btn-text-fixed">Volver a productos</span>
            </button>
            
            <button class="btn-categoria-fixed" (click)="verMasDeEstaCategoria()" *ngIf="producto.categoria">
              <span class="btn-icon-fixed">üìÇ</span>
              <span class="btn-text-fixed">Ver m√°s de {{producto.categoria}}</span>
            </button>
          </div>

        </div> <!-- Fin del contenedor scroll -->

      </div> <!-- Fin columna derecha -->

    </div> <!-- Fin layout container -->

  </div> <!-- Fin producto-detalles -->
</div> <!-- Fin description-producto-container -->

<!-- Modal de imagen ampliada -->
<div *ngIf="mostrarModalImagen" class="image-modal-backdrop" (click)="cerrarModalImagen()">
  <div class="image-modal-container" (click)="$event.stopPropagation()">
    <button class="image-modal-close" (click)="cerrarModalImagen()" title="Cerrar (Esc)">
      ‚úï
    </button>
    <div class="image-modal-content">
      <img [src]="imagenModalUrl" [alt]="nombreCompleto">
      <div class="image-modal-info">
        {{nombreCompleto}}
      </div>
    </div>
  </div>
</div>