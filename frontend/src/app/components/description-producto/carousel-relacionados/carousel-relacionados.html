<section class="productos-relacionados-section">
  <!-- üîπ Encabezado de la secci√≥n -->
  <div class="section-header" *ngIf="productos.length > 0">
    <h2 class="section-title">{{ titulo }}</h2>
    <p class="section-subtitle">{{ subtitulo }}</p>
  </div>

  <!-- üîπ Estado de carga -->
  <div class="loading-state" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Cargando productos relacionados...</p>
  </div>

  <!-- üîπ Estado de error -->
  <div class="error-state" *ngIf="error && !isLoading">
    <div class="error-icon">‚ö†Ô∏è</div>
    <h3>No se pudieron cargar productos relacionados</h3>
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="recargar()">Reintentar</button>
  </div>

  <!-- üîπ Contenedor del carrusel -->
 <div class="carousel-container" *ngIf="productos.length > 0 && !isLoading">
  <!-- Bot√≥n de navegaci√≥n anterior -->
  <button class="carousel-nav prev" 
          (click)="scrollCarousel('prev')" 
          [disabled]="!isPrevEnabled()"
          aria-label="Productos anteriores"
          [class.disabled]="!isPrevEnabled()">
    ‚Äπ
  </button>

  <!-- Wrapper del carrusel -->
  <div class="carousel-wrapper">
    <div class="carousel" [id]="carouselId">
      <!-- Items del carrusel -->
      <div class="carousel-item" 
           *ngFor="let producto of productos; let i = index">
        
        <a [routerLink]="['/producto', producto.id]" class="producto-card">
          
          <!-- Contenedor de la imagen del producto -->
          <div class="producto-image-container">
            <div class="image-wrapper">
              <img [src]="getProductoImagen(producto)" 
                   [alt]="producto.nombre"
                   class="producto-image"
                   (error)="handleImageError($event, producto)">
              <div class="image-glow"></div>
            </div>
          </div>

          <!-- Contenedor del texto -->
          <div class="producto-text-container">
            <div class="producto-content">
              <!-- Nombre del producto - UNA SOLA L√çNEA -->
              <h3 class="producto-title" [title]="producto.nombre">
                {{ producto.nombre }}
              </h3>
              
              <!-- Subcategor√≠a -->
              <div class="producto-subcategoria">
                <span class="subcategoria-badge">
                  {{ producto.subcategoria || 'Sin categor√≠a' }}
                </span>
              </div>

              <!-- Precio -->
              <div class="producto-precio" *ngIf="producto.precio">
                <span class="precio-actual">
                  {{ producto.precio | currency:'USD':'symbol':'1.2-2' }}
                </span>
              </div>

              <!-- Enlace para ver m√°s -->
              <div class="producto-actions">
                <span class="ver-producto-link">
                  Ver producto
                  <span class="arrow">‚Üí</span>
                </span>
              </div>
            </div>
          </div>
        </a>
      </div>
    </div>
  </div>

  <!-- Bot√≥n de navegaci√≥n siguiente -->
  <button class="carousel-nav next" 
          (click)="scrollCarousel('next')" 
          [disabled]="!isNextEnabled()"
          aria-label="Siguientes productos"
          [class.disabled]="!isNextEnabled()">
    ‚Ä∫
  </button>
</div>

    <!-- Bot√≥n de navegaci√≥n siguiente -->
    <button class="carousel-nav next" 
            (click)="scrollCarousel('next')" 
            [disabled]="!isNextEnabled()"
            aria-label="Siguientes productos"
            [class.disabled]="!isNextEnabled()">
      ‚Ä∫
    </button>
  

  
  <!-- üîπ Mensaje si no hay productos relacionados -->
  <div class="no-productos" *ngIf="productos.length === 0 && !isLoading && !error">
    <div class="no-productos-icon">üì¶</div>
    <h3>No hay productos relacionados</h3>
    <p>Explora otras categor√≠as para encontrar m√°s productos.</p>
  </div>

  <!-- üîπ Informaci√≥n de depuraci√≥n (solo en desarrollo) -->
  <div class="debug-info" *ngIf="false"> <!-- Cambiar a true para depuraci√≥n -->
    <h4>Informaci√≥n de depuraci√≥n:</h4>
    <p>Producto actual: {{ getProductoActualInfo() }}</p>
    <p>Subcategor√≠a ID: {{ subcategoriaId }}</p>
    <p>Producto ID: {{ productoId }}</p>
    <p>Productos cargados: {{ productos.length }}</p>
  </div>
</section>